(()=>{var e={};e.id=3,e.ids=[3],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},7310:e=>{"use strict";e.exports=require("url")},8681:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>d.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>g,tree:()=>o});var r=a(7096),s=a(6132),l=a(7284),d=a.n(l),n=a(2564),i={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>n[e]);a.d(t,i);let o=["",{children:["admin",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,3729)),"C:\\Users\\prana\\CascadeProjects\\template-creator\\app\\admin\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,5345)),"C:\\Users\\prana\\CascadeProjects\\template-creator\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,9291,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\prana\\CascadeProjects\\template-creator\\app\\admin\\page.tsx"],u="/admin/page",m={require:a,loadChunk:()=>Promise.resolve()},g=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/admin/page",pathname:"/admin",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},442:(e,t,a)=>{Promise.resolve().then(a.bind(a,4082))},4082:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>AdminPage});var r=a(784),s=a(9885),l=a(9546),d=a(6315),n=a(8838),i=a(443),o=a(2995),c=a(1910),u=a(1922),m=a(6303),g=a(2170);function AdminPage(){let[e,t]=(0,s.useState)({name:"",description:"",category:"",backgroundImage:"",width:800,height:600,placeholders:[],isPdf:!1,totalPages:1}),[a,h]=(0,s.useState)(null),[p,x]=(0,s.useState)(null),[b,f]=(0,s.useState)(null),[j,y]=(0,s.useState)(null),[v,w]=(0,s.useState)(0),[P,N]=(0,s.useState)(null),[C,k]=(0,s.useState)([]),_=(0,s.useRef)(null),[I,D]=(0,s.useState)(null);(0,s.useEffect)(()=>{let loadPdfLib=async()=>{try{let e=document.createElement("script");e.src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js",e.onload=()=>{D(window.PDFLib)},document.head.appendChild(e);let t=document.createElement("script");t.src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js",document.head.appendChild(t)}catch(e){console.error("Error loading pdf libraries:",e)}};loadPdfLib()},[]);let renderPdfPage=async(e,t)=>{if(!I)return"";try{if(window.pdfjsLib){let a=await e.save(),r=window.pdfjsLib.getDocument({data:a}),s=await r.promise,l=await s.getPage(t+1),d=l.getViewport({scale:1.5}),n=document.createElement("canvas"),i=n.getContext("2d");return n.height=d.height,n.width=d.width,await l.render({canvasContext:i,viewport:d}).promise,n.toDataURL()}{let a=await I.PDFDocument.create(),[r]=await a.copyPages(e,[t]);a.addPage(r);let s=await a.save(),l=new Blob([s],{type:"application/pdf"});return URL.createObjectURL(l)}}catch(e){return console.error("Error rendering PDF page:",e),""}},processPdfFile=async e=>{if(I)try{let a=await e.arrayBuffer(),r=await I.PDFDocument.load(a),s=r.getPageCount(),l=r.getPage(0),{width:d,height:n}=l.getSize();N(r),t(e=>({...e,isPdf:!0,totalPages:s,width:d,height:n}));let i=[];for(let e=0;e<s;e++){let t=await renderPdfPage(r,e);i.push(t)}k(i),w(0)}catch(e){console.error("Error processing PDF:",e),alert("Error processing PDF file")}},F=(0,s.useCallback)(async e=>{let a=e[0];if(a){if(y(a),"application/pdf"===a.type)await processPdfFile(a);else{let e=URL.createObjectURL(a),r=new Image;r.onload=()=>{t(t=>({...t,backgroundImage:e,width:r.width,height:r.height,isPdf:!1,totalPages:1}))},r.src=e}}},[I]),{getRootProps:S,getInputProps:T,isDragActive:q}=(0,g.uI)({onDrop:F,accept:{"image/*":[".png",".jpg",".jpeg",".gif"],"application/pdf":[".pdf"]},multiple:!1}),updatePlaceholder=(e,a)=>{t(t=>({...t,placeholders:t.placeholders.map(t=>t.id===e?{...t,...a}:t)}))},deletePlaceholder=e=>{t(t=>({...t,placeholders:t.placeholders.filter(t=>t.id!==e)})),h(null)},handlePlaceholderMouseDown=(e,t)=>{e.stopPropagation(),f(t),h(t)},navigateToPage=t=>{"prev"===t&&v>0?w(v-1):"next"===t&&v<(e.totalPages||1)-1&&w(v+1)},saveTemplate=async()=>{try{let a=new FormData;j&&a.append("file",j),a.append("template",JSON.stringify(e));let r=await fetch("/api/templates",{method:"POST",body:a});r.ok&&(alert("Template saved successfully!"),t({name:"",description:"",category:"",backgroundImage:"",width:800,height:600,placeholders:[],isPdf:!1,totalPages:1}),y(null),N(null),k([]),w(0))}catch(e){console.error("Error saving template:",e),alert("Error saving template")}},R=e.placeholders.filter(t=>!e.isPdf||t.pageIndex===v),B=e.placeholders.find(e=>e.id===a),getCurrentBackgroundImage=()=>e.isPdf&&C[v]?C[v]:e.backgroundImage;return r.jsx("div",{className:"min-h-screen bg-gray-50",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Template Admin"}),r.jsx("p",{className:"text-gray-600",children:"Create and manage templates with interactive placeholders. Now supports PDFs with page navigation!"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white text-black rounded-lg shadow p-6",children:[r.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Template Details"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:e.name,onChange:e=>t(t=>({...t,name:e.target.value})),placeholder:"Template name"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),r.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,value:e.description,onChange:e=>t(t=>({...t,description:e.target.value})),placeholder:"Template description"})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-black mb-1",children:"Category"}),(0,r.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:e.category,onChange:e=>t(t=>({...t,category:e.target.value})),children:[r.jsx("option",{value:"",children:"Select category"}),r.jsx("option",{value:"Certificate",children:"Certificate"}),r.jsx("option",{value:"Business Card",children:"Business Card"}),r.jsx("option",{value:"Flyer",children:"Flyer"}),r.jsx("option",{value:"Poster",children:"Poster"}),r.jsx("option",{value:"Invoice",children:"Invoice"}),r.jsx("option",{value:"Resume",children:"Resume"})]})]}),e.isPdf&&(0,r.jsxs)("div",{className:"bg-blue-50 p-3 rounded-md",children:[(0,r.jsxs)("div",{className:"flex items-center text-blue-700",children:[r.jsx(l.Z,{className:"w-4 h-4 mr-2"}),r.jsx("span",{className:"text-sm font-medium",children:"PDF Template"})]}),(0,r.jsxs)("p",{className:"text-sm text-blue-600 mt-1",children:[e.totalPages," pages â€¢ Current: Page ",v+1]})]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Upload Background"}),(0,r.jsxs)("div",{...S(),className:`border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors ${q?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,children:[r.jsx("input",{...T()}),r.jsx(d.Z,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),r.jsx("p",{className:"text-sm text-gray-600",children:q?"Drop the file here":"Drag & drop PDF or image, or click to select"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Supports: PNG, JPG, PDF"})]}),j&&(0,r.jsxs)("p",{className:"mt-2 text-sm text-green-600",children:["Uploaded: ",j.name]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[r.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Add Placeholders"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("button",{onClick:()=>x("text"),className:`w-full flex items-center justify-center px-4 py-2 rounded-md transition-colors ${"text"===p?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[r.jsx(n.Z,{className:"w-4 h-4 mr-2"}),"Add Text Placeholder"]}),(0,r.jsxs)("button",{onClick:()=>x("image"),className:`w-full flex items-center justify-center px-4 py-2 rounded-md transition-colors ${"image"===p?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[r.jsx(i.Z,{className:"w-4 h-4 mr-2"}),"Add Image Placeholder"]})]}),p&&(0,r.jsxs)("p",{className:"mt-2 text-sm text-blue-600",children:["Click on the canvas to place the ",p," placeholder",e.isPdf&&` on page ${v+1}`]})]}),r.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:r.jsx("div",{className:"space-y-2",children:(0,r.jsxs)("button",{onClick:saveTemplate,className:"w-full bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition-colors flex items-center justify-center",disabled:!e.name||!e.backgroundImage&&0===C.length,children:[r.jsx(o.Z,{className:"w-4 h-4 mr-2"}),"Save Template"]})})})]}),(0,r.jsxs)("div",{className:"lg:col-span-2",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-lg font-semibold",children:"Template Canvas"}),e.isPdf&&e.totalPages>1&&(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("button",{onClick:()=>navigateToPage("prev"),disabled:0===v,className:"p-2 rounded-md bg-gray-100 hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",children:r.jsx(c.Z,{className:"w-4 h-4"})}),(0,r.jsxs)("span",{className:"text-sm text-gray-600",children:["Page ",v+1," of ",e.totalPages]}),r.jsx("button",{onClick:()=>navigateToPage("next"),disabled:v===e.totalPages-1,className:"p-2 rounded-md bg-gray-100 hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",children:r.jsx(u.Z,{className:"w-4 h-4"})})]})]}),getCurrentBackgroundImage()?r.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden bg-white",children:r.jsx("div",{className:"flex justify-center items-center min-h-[500px] p-4",children:(0,r.jsxs)("div",{ref:_,className:"relative cursor-crosshair shadow-lg border border-gray-200 rounded-lg",style:{width:"fit-content",height:"fit-content",maxWidth:"100%",maxHeight:"80vh",backgroundColor:"#ffffff"},onClick:a=>{if(!p)return;let r=_.current?.getBoundingClientRect();if(!r)return;let s=_.current.querySelector("img, embed");if(!s)return;let l=s.getBoundingClientRect(),d=e.width/l.width,n=e.height/l.height,i=(a.clientX-l.left)*d,o=(a.clientY-l.top)*n,c={id:`placeholder-${Date.now()}`,type:p,x:i,y:o,width:"text"===p?200:150,height:"text"===p?30:100,fontSize:16,fontFamily:"Arial",color:"#000000",placeholder:"text"===p?"Enter text here":"Upload image",required:!0,pageIndex:e.isPdf?v:0};t(e=>({...e,placeholders:[...e.placeholders,c]})),x(null)},onMouseMove:t=>{if(!b)return;let a=_.current?.getBoundingClientRect();if(!a)return;let r=_.current.querySelector("img, embed");if(!r)return;let s=r.getBoundingClientRect(),l=e.width/s.width,d=e.height/s.height,n=(t.clientX-s.left)*l,i=(t.clientY-s.top)*d;updatePlaceholder(b,{x:n,y:i})},onMouseUp:()=>{f(null)},children:[window.pdfjsLib&&e.isPdf?r.jsx("img",{src:getCurrentBackgroundImage(),alt:"PDF page",className:"w-full h-auto object-contain",draggable:!1,style:{maxWidth:"100%",maxHeight:"70vh",height:"auto",width:"auto"}}):e.isPdf?r.jsx("embed",{src:getCurrentBackgroundImage(),className:"w-full h-auto object-contain",type:"application/pdf",style:{maxWidth:"100%",maxHeight:"70vh",height:"auto"}}):r.jsx("img",{src:getCurrentBackgroundImage(),alt:"Template background",className:"w-full h-auto object-contain",draggable:!1,style:{maxWidth:"100%",maxHeight:"70vh",height:"auto"}}),R.map(t=>{let s=_.current?.querySelector("img, embed"),l=t.x,d=t.y,o=t.width,c=t.height;if(s){let a=s.getBoundingClientRect(),r=_.current?.getBoundingClientRect();if(r){let r=a.width/e.width,s=a.height/e.height;l=t.x*r,d=t.y*s,o=t.width*r,c=t.height*s}}return(0,r.jsxs)("div",{className:`absolute border-2 cursor-move ${a===t.id?"border-blue-500 bg-blue-100":"border-red-400 bg-red-100"} bg-opacity-50 flex items-center justify-center text-xs font-medium`,style:{left:l,top:d,width:o,height:c},onMouseDown:e=>handlePlaceholderMouseDown(e,t.id),children:["text"===t.type?r.jsx(n.Z,{className:"w-4 h-4"}):r.jsx(i.Z,{className:"w-4 h-4"}),r.jsx("span",{className:"ml-1",children:t.type}),e.isPdf&&(0,r.jsxs)("span",{className:"ml-1 text-xs bg-gray-200 px-1 rounded",children:["P",(t.pageIndex||0)+1]})]},t.id)})]})})}):r.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg h-96 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx(d.Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-500",children:"Upload a background image or PDF to start"})]})})]}),B&&(0,r.jsxs)("div",{className:"mt-6 bg-white text-black rounded-lg shadow p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Placeholder Properties"}),r.jsx("button",{onClick:()=>deletePlaceholder(B.id),className:"text-red-600 hover:text-red-800 p-1",children:r.jsx(m.Z,{className:"w-4 h-4"})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"X Position"}),r.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:B.x,onChange:e=>updatePlaceholder(B.id,{x:parseInt(e.target.value)})})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Y Position"}),r.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:B.y,onChange:e=>updatePlaceholder(B.id,{y:parseInt(e.target.value)})})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Width"}),r.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:B.width,onChange:e=>updatePlaceholder(B.id,{width:parseInt(e.target.value)})})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Height"}),r.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:B.height,onChange:e=>updatePlaceholder(B.id,{height:parseInt(e.target.value)})})]}),e.isPdf&&(0,r.jsxs)("div",{className:"col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Page"}),r.jsx("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:B.pageIndex||0,onChange:e=>updatePlaceholder(B.id,{pageIndex:parseInt(e.target.value)}),children:Array.from({length:e.totalPages||1},(e,t)=>(0,r.jsxs)("option",{value:t,children:["Page ",t+1]},t))})]}),"text"===B.type&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Font Size"}),r.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:B.fontSize,onChange:e=>updatePlaceholder(B.id,{fontSize:parseInt(e.target.value)})})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Font Family"}),(0,r.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:B.fontFamily,onChange:e=>updatePlaceholder(B.id,{fontFamily:e.target.value}),children:[r.jsx("option",{value:"Arial",children:"Arial"}),r.jsx("option",{value:"Helvetica",children:"Helvetica"}),r.jsx("option",{value:"Times New Roman",children:"Times New Roman"}),r.jsx("option",{value:"Georgia",children:"Georgia"})]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Color"}),r.jsx("input",{type:"color",className:"w-full h-10 border border-gray-300 rounded-md",value:B.color,onChange:e=>updatePlaceholder(B.id,{color:e.target.value})})]})]}),(0,r.jsxs)("div",{className:"col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Placeholder Text"}),r.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:B.placeholder,onChange:e=>updatePlaceholder(B.id,{placeholder:e.target.value})})]}),r.jsx("div",{className:"col-span-2",children:(0,r.jsxs)("label",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",className:"mr-2",checked:B.required,onChange:e=>updatePlaceholder(B.id,{required:e.target.checked})}),"Required field"]})})]})]})]})]})]})})}},3729:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>d,__esModule:()=>l,default:()=>i});var r=a(5153);let s=(0,r.createProxy)(String.raw`C:\Users\prana\CascadeProjects\template-creator\app\admin\page.tsx`),{__esModule:l,$$typeof:d}=s,n=s.default,i=n}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),a=t.X(0,[862,607,590,786,283],()=>__webpack_exec__(8681));module.exports=a})();